---
// src/layouts/Layout.astro lolme.cc
import Footer from "../components/Footer.astro";
import AdsInjector from "../components/AdsInjector.astro";
const { title = "", description, img, ogImage } = Astro.props;
import "../../css/style.css";

// Ù„Ùˆ Ù…ÙÙŠØ´ ogImage â†’ Ù†Ø³ØªØ®Ø¯Ù… img
const makeAbsolute = (url: string = ""): string =>
  url.startsWith("http") ? url : `https://lolme.cc${url}`;

const finalOg = makeAbsolute(ogImage || img || "/images/default-og.webp");
---

<html lang="ar" dir="rtl">
  <head>
    <!-- BASIC -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Fix Status Bar Color (PWA) -->
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0F1723" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#fefefe" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <slot name="head"></slot>

    <!-- SEO DESCRIPTION -->
    <meta 
      name="description" content={description || "Ù…Ø­ØªÙˆÙ‰ Ù…Ø¶Ø­Ùƒ ÙˆÙ…ÙŠÙ…Ø² ÙŠÙˆÙ…ÙŠØ© ÙˆØ£ÙØ´Ø§ØªØŒ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø´Ø®ØµÙŠØ© Ù…Ø¶Ø­ÙƒØ©ØŒ ÙˆØªØ­ÙˆÙŠÙ„ ØµÙˆØ± ÙˆÙ…Ø­ØªÙˆÙ‰ ØªØ±ÙÙŠÙ‡ÙŠ Ø³Ø±ÙŠØ¹ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ LOLME"} />

    <!-- TITLE -->
    <title>{title || "LOLME - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø¶Ø­ÙƒØ© ÙˆÙ…ÙŠÙ…Ø² ÙˆØ±ÙˆØ³Øª ØµØ§Ø­Ø¨Ùƒ"}</title>

    <!-- CANONICAL -->
    <link rel="preconnect" href="https://www.googletagmanager.com">
    <link rel="preconnect" href="https://www.google-analytics.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">    
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="canonical" href={`https://lolme.cc${Astro.url.pathname}`} />
    <link rel="preload" href="/favicon.webp" as="image">

    <!-- OG TAGS -->
    <meta property="og:title" content={title || "LOLME - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø¶Ø­ÙƒØ© ÙˆÙ…ÙŠÙ…Ø²"} />
    <meta property="og:description" content={description || "Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø¶Ø­ÙƒØ©ØŒ Ù…ÙŠÙ…Ø² ÙŠÙˆÙ…ÙŠØ©ØŒ ØµÙˆØ± Ù…Ø¶Ø­ÙƒØ©ØŒ Ø£ÙØ´Ø§ØªØŒ ÙˆØªÙ‚Ù†ÙŠØ§Øª ØªØ±ÙÙŠÙ‡ÙŠØ© Ù‡Ø§ÙŠÙØ© ÙˆØ¬Ø§Ù…Ø¯Ø© ÙÙŠ LOLME ğŸ˜‚ğŸ”¥"} />
    <meta property="og:image" content={finalOg} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={`https://lolme.cc${Astro.url.pathname}`} />
    
    <!-- bing.com/webmasters -->
    <meta name="msvalidate.01" content="2AFF695811779AE6FD6B606480E183D0" />
    <meta name="yandex-verification" content="fc837038f6a4dcdd" />
    <!-- TWITTER TAGS -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title || "LOLME - Ù…ÙŠÙ…Ø² ÙˆÙ†ÙƒØª"} />
    <meta name="twitter:description" content={description || "Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆÙ…ÙŠÙ…Ø² ÙˆÙ†ÙƒØª ÙˆØµÙˆØ± Ù…Ø¶Ø­ÙƒØ© ÙˆØ±ÙˆØ³ØªØ§Øª Ø¬Ø§Ù‡Ø²Ø© Ø¹Ù„Ù‰ LOLME"} />
    <meta name="twitter:image" content={finalOg} />

    <!-- EXTRA VERIFICATION -->
    <meta name="mylead-verification" content="71d6df0ab7b92b5fe986e8cae0205e5f" />

    <!-- FAVICON + MANIFEST -->
    <link rel="manifest" href="/manifest.json" />
    <link rel="icon" type="image/png" href="/favicon64.png" />
    <meta name="theme-color" content="#1f8ef1" />

    <!-- ADS + ANALYTICS -->
    <script>
      window.addEventListener("load", () => {
        const s1 = document.createElement("script");
        s1.src = "https://www.googletagmanager.com/gtag/js?id=G-98W71513M3";
        s1.async = true;
        document.body.appendChild(s1);
    
        const s2 = document.createElement("script");
        s2.src = "/js/googletagmanager.js";
        s2.type = "module";
        document.body.appendChild(s2);
      });
    </script>
    
    <!-- PWAs + EXTRA -->
    <script src="/js/ad-close.js" defer></script>
    <!-- <script type="module" src="/js/register-sw.js"></script> -->
    <script>
      window.addEventListener("load", () => {
        const s = document.createElement("script");
        s.src = "/js/register-sw.js";
        document.body.appendChild(s);
      });
    </script>
    
  </head>

  <body>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker
            .register('/service-worker.js')
            .then(() => console.log('âœ… Service Worker registered'))
            .catch(err => console.error('âŒ SW registration failed:', err));
        });
      }
    </script>
    
    <main>
  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø«Ø§Ø¨Øª -->
  <!-- <header class="page-header" style=" display:flex; justify-content:space-between; align-items:center; width:100%; max-width:1000px; margin:0 auto; padding:0.5rem 1rem; background:transparent; " > -->
    <header class="page-header" style="display:flex;justify-content:space-around;align-items:center;width:94%;padding:0rem 1rem;background:#0000;">     
    <!-- Ø§Ù„ÙŠÙ…ÙŠÙ†: Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª -->
    <nav class="header-nav" style="display:flex; gap:10px; align-items:center;">
      <a id="nav-home" href="/">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <span class="divider">|</span>
      <a id="nav-articles" href="/articles">ğŸ“š Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</a>
  
      <span id="toggle-theme" style="cursor:pointer; font-size:1.5rem;" > ğŸŒ™ </span>
    </nav>
    
  <!-- Ø§Ù„ÙŠØ³Ø§Ø±: Ø§Ù„Ù„ÙˆØ¬Ùˆ -->
  <div class="header-left" style="display:flex; align-items:center;">
    <img src="/favicon.webp" alt="LOLME" width="40" height="40" class="logo" />
  </div>

</header>

  <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
  {Astro.props.title && (
    <div class="page-title">
      <h1>{Astro.props.title}</h1>
      {Astro.props.description && (
        <p class="description">{Astro.props.description}</p>
      )}
    </div>
  )}

{img && (
  <div style="text-align:center; margin: 20px auto;">
    <img 
      src={img} 
      alt={title} 
      style="
        max-width: 600px; 
        width: 90%; 
        border-radius: 14px; 
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      "
      class="tilt-card"
    />
  </div>
)}

    <!-- Ø¥Ø¹Ù„Ø§Ù† ÙÙˆÙ‚ -->
    <!-- <AdsInjector showTop={true} showSide={true} showFloating={true} showBottom={false} /> -->

    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© -->
    <div class="page-content article">
      <slot />
    </div>

    <!-- Ø¥Ø¹Ù„Ø§Ù† ØªØ­Øª -->
    <!-- <AdsInjector showTop={false} showSide={false} showFloating={false} showBottom={true} /> -->

    </main>
    <!-- <div class="ad-space">Ù…Ø³Ø§Ø­ØªÙƒ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ù‡Ù†Ø§</div> -->

    <Footer />
    <script type="module">
      document.addEventListener("DOMContentLoaded", () => {
        const themeToggle = document.getElementById("toggle-theme");
        if (!themeToggle) return; // Ù„Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø®Ø±Ø¬
    
        function applyTheme(theme) {
          if(theme === "light") {
            document.body.classList.add("light-theme");
            themeToggle.textContent = "ğŸŒ";
          } else {
            document.body.classList.remove("light-theme");
            themeToggle.textContent = "ğŸŒ™";
          }
        }
    
        const savedTheme = localStorage.getItem("theme") || "dark";
        applyTheme(savedTheme);
    
        themeToggle.addEventListener("click", () => {
          const newTheme = document.body.classList.contains("light-theme") ? "dark" : "light";
          applyTheme(newTheme);
          localStorage.setItem("theme", newTheme);
        });
      });
    </script>
    <!-- <script>
      setTimeout(() => {
        document.dispatchEvent(new Event("load-ads"));
      }, 700);
    </script>
     -->
  </body>
</html>

<style>
  .page-title {
    max-width: 1000px;      /* Ù†ÙØ³ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø§Ù„ */
    margin: 20px auto;       /* ÙŠØ³Ù†ØªØ± Ø§Ù„Ù€ div Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø© */
    text-align: center;      /* ÙŠØ³Ù†ØªØ± Ø§Ù„Ù†ØµÙˆØµ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ div */
    padding: 0 15px;         /* Ù…Ø³Ø§ÙØ© Ø¯Ø§Ø®Ù„ÙŠØ© Ø¨Ø³ÙŠØ·Ø© */
  }

  .page-title h1 {
    font-size: 2rem;
    margin-bottom: 10px;
  }

  .page-title .description {
    font-size: 1.1rem;
    color: var(--accent-color);
    line-height: 1.6;
  }

  .logo {
    vertical-align: middle;
  }

</style>