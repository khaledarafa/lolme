---
// scripts/generate-memes-json.js
// node scripts/generate-memes-json.js
// node scripts/generate-sitemap.js

// firebase deploy --only functions
// npx astro dev --host
// npm run build 

// rm -rf dist
// npx astro build
// vercel deploy
// vercel --prod

// mkdir -p dist
// npx astro build

// git add .
// git commit -m ""
// git push

// src/pages/index.astro
export const prerender = false;
import Layout from "../layouts/Layout.astro";

// Ù†Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
const articlesModules = import.meta.glob('./articles/*.astro', { eager: true });

interface ArticleFrontmatter {
  title: string;
  description?: string;
  image?: string;
  date?: string;
}

interface ArticleWithSlug extends ArticleFrontmatter {
  slug: string;
}

const articles: ArticleWithSlug[] = Object.entries(articlesModules)
  .filter(([path]) => !path.endsWith('index.astro'))
  .map(([path, module]) => {
    const mod = module as { frontmatter?: ArticleFrontmatter };
    const fm = mod.frontmatter as ArticleFrontmatter; // Ù†Ø¬Ø¨Ø± TypeScript ÙŠØ¹Ø±Ù Ø§Ù„Ù†ÙˆØ¹
    return {
      slug: path.replace('./articles/', '').replace('.astro', ''),
      title: fm.title,
      description: fm.description ?? '',
      image: fm.image ?? '/images/default-article.webp',
      date: fm.date ?? '2000-01-01',
    };
  })
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()) // Ø§Ù„Ø£Ø­Ø¯Ø« ÙÙˆÙ‚
  .slice(0, 5);

const homeButtons = [
  {
    title: "ğŸ”® Ø¥Ø®ØªØ¨Ø§Ø±Ø§Øª Ù…Ø¶Ø­ÙƒØ©",
    slug: "/tests",
    img: "/images/tests.webp",
  },
  {
    title: "ğŸ¤£ Ù†ÙƒØª Ù…Ø¶Ø­ÙƒØ©",
    slug: "/jokes",
    img: "/images/jokes.webp",
  },
  {
    title: "ğŸ“¸ Ø§Ø¹Ù…Ù„ Ù…ÙŠÙ…ÙŠØ² Ø¯Ù„ÙˆÙ‚ØªÙŠ",
    slug: "/meme",
    img: "/images/meme.webp",
  },
  {
    title: "ğŸ”¥ Ø±ÙˆÙ‘Ø³Øª ØµØ§Ø­Ø¨Ùƒ",
    slug: "/roast",
    img: "/images/roast.webp",
  },
  {
    title: "ğŸ¤£ ØµÙˆØ± Ù…Ø¶Ø­ÙƒØ©",
    slug: "/funnyImages",
    img: "/images/funny.webp",
  },
  {
    title: "Ø­ÙˆÙ‘Ù„ PDF Ø¥Ù„Ù‰ ØµÙˆØ± ğŸ¤¯",
    slug: "/pdf-to-images",
    img: "/images/pdf2imgs.webp",
  },
];

---

<Layout title="ğŸ¤£ LOLME">
  <section style="text-align:center; padding: 0px 0.1rem ;">
    <!-- <h1>ğŸ¤£ LOLME</h1> -->
    <p style="margin: 0px;"> Ø£Ø¯ÙˆØ§Øª ØªØ±ÙÙŠÙ‡ÙŠØ© Ù‡Ø§ÙŠÙØ© ÙˆÙ…Ø¬Ù†ÙˆÙ†Ø© ğŸ•ºğŸ”¥</p>
    <p> LOLME Ù‡Ùˆ Ù…ÙƒØ§Ù†Ùƒ Ù„Ù„Ø¶Ø­Ùƒ ÙˆØ§Ù„Ù‡Ø²Ø§Ø±! Ø§Ø±ÙØ¹ ØµÙˆØ±Ø©ØŒ Ø§ÙƒØªØ¨ Ù…ÙŠÙ…Ø²ØŒ ÙˆØ±ÙˆÙ‘Ø³Øª Ø£ØµØ­Ø§Ø¨Ùƒ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø±Ø­Ø© ğŸ˜ </p>
    <button id="install-btn" class="appbtn" style="background:#f39c12;">â¬‡ï¸ Ø­Ù…Ù‘Ù„ LOLME ÙƒØªØ·Ø¨ÙŠÙ‚</button>

  </section>

  <div class="imojidiv">
    <div class="emoji" style=" font-size:2rem;">ğŸ¤£</div>
    <div class="emoji" style="left:20%;">ğŸ¤£</div>
    <div class="emoji" style="left:35%;">ğŸ˜‚</div>
    <div class="emoji" style="left:50%;">ğŸ˜</div>
    <div class="emoji" style="left:65%;">ğŸ¥³</div>
    <div class="emoji" style="left:80%;">ğŸ¤ª</div>
    <div class="emoji" style=" font-size:2rem;">ğŸ¥³</div>
  </div>
  <main class="home-grid">
    {homeButtons.map((btn) => (
      <a href={btn.slug} class="home-card tilt-card">
        <img src={btn.img} alt={btn.title} loading="lazy" />
        <div class="content">
          <h3>{btn.title}</h3>
        </div>
      </a>
    ))}
  </main>

  <section>
    <h2>ğŸ“° Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</h2>
    <div class="articles-grid">
      {articles.map(article => (
        <a href={`/articles/${article.slug}`} class="article-card tilt-card">
          <img src={article.image ? article.image : '/images/default-article.webp'} alt={article.title} />
          <h3>{article.title}</h3>
          <p>{article.description}</p>
        </a>
      ))}
    </div>
  </section>

  <script type="module" src="/js/install-btn.js"></script>
  <script type="module" src="/js/open-meme.js"></script>
  <script type="module" src="/js/tilt-cards.js"></script>

</Layout>
<style>
  .home-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    max-width: 1000px;
    margin: auto;
    padding: 40px 8px;
  }

  .home-card {
    text-decoration: none;
    color: inherit;
    background: var(--bg-color);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 6px 15px var(--shadow-color);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .home-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 15px rgb(241, 249, 16);
  }

  .home-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .home-card .content {
    padding: 10px;
    text-align: center;
  }

  .home-card h3 {
    font-size: 1.1rem;
    margin: 0;
    color: var(--accent);
  }

/* =============== articles =============== */
.articles-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 20px 0;
}
.article-card {
  display: flex;
  flex-direction: column;
  background: var(--bg-color);
  border-radius: 8px;
  overflow: hidden;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 4px 10px var(--shadow-color);
  transition: transform 0.2s;
}
.article-card:hover { transform: translateY(-3px); }
.article-card img { width: 100%; height: 150px; object-fit: cover; }
.article-card h3 { margin: 10px; font-size: 1.1rem; }
.article-card p { margin: 0 10px 10px; font-size: 0.9rem; color: var(--text-muted); }
</style>