---
// src/pages/tests/Inner-peace.astro
export const prerender = false;
import Layout from "../../layouts/Layout.astro";
import { otherQuizzes } from "../../data/otherQuizzes.js";

const title = "Ù‚ÙŠØ³ Ù‚ÙˆØ© Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø¹Ù†Ø¯Ùƒ ğŸ”ğŸ§˜â€â™‚ï¸âœ¨";
const img = "/images/peace.webp";

interface Option {
  text: string;
  value: "low" | "medium" | "high" | "panic";
}

interface Question {
  question: string;
  options: Option[];
}

function shuffle<T>(arr: T[]): T[] {
  return arr.sort(() => Math.random() - 0.5);
}

const questions: Question[] = shuffle([
  {
    question: "Ù„Ù…Ø§ Ø§Ù„Ø¯Ù†ÙŠØ§ ØªÙ„Ø®Ø¨Ø· ÙØ¬Ø£Ø©â€¦ Ø¨ØªØ±Ø¬Ø¹ Ù„Ù‡Ø¯ÙˆØ¡Ùƒ Ø¨Ø³Ø±Ø¹Ø© ÙˆÙ„Ø§ Ø¨ØªØªÙˆØªØ±ØŸ",
    options: shuffle([
      { text: "Ø¨Ø±Ø¬Ø¹ Ø£Ø±ÙˆÙ‚ ÙÙŠ Ø«ÙˆØ§Ù†ÙŠ âœ¨", value: "low" },
      { text: "Ø¨Ø§Ø®Ø¯ Ù„Ø­Ø¸Ø© ÙƒØ¯Ù‡ ÙˆØ£Ù‡Ø¯ÙŠ ğŸ¤", value: "medium" },
      { text: "Ø¨ØªÙˆØªØ± ÙˆÙ…Ø´ Ø¨Ø¹Ø±Ù Ø£Ø±Ø¬Ø¹ Ø£Ø¸Ø¨Ø· Ù†ÙØ³ÙŠ Ø¨Ø³Ù‡ÙˆÙ„Ø© ğŸ˜Ÿ", value: "high" },
      { text: "Ø¨Ø¯Ø®Ù„ ÙÙŠ Ù‚Ù„Ù‚ ÙˆØ¶ØºØ· ÙˆÙ…Ø´ Ø¨Ø¹Ø±Ù Ø£Ù‡Ø¯Ù‰ Ø®Ø§Ù„Øµ ğŸ˜£", value: "panic" },
    ]),
  },
  {
    question: "ØµÙˆØªÙƒ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠâ€¦ ØºØ§Ù„Ø¨Ù‹Ø§ Ù‡Ø§Ø¯ÙŠ ÙˆÙ„Ø§ Ù…Ø²Ø¹Ø¬ ÙˆÙ…Ø´ØºÙ‘Ù„ Ø¯Ù…Ø§ØºÙƒ Ø¹Ù„Ù‰ Ø·ÙˆÙ„ØŸ",
    options: shuffle([
      { text: "Ù‡Ø§Ø¯ÙŠ ÙˆÙ…Ø±ÙŠØ­â€¦ ØµØ¯ÙŠÙ‚ Ù…Ø´ Ø¹Ø¯Ùˆ ğŸ§˜â€â™‚ï¸", value: "low" },
      { text: "Ø£ÙˆÙ‚Ø§Øª Ø¨ÙŠØ²Ù†â€¦ Ø¨Ø³ Ø¨Ø³ÙŠØ·Ø± Ø¹Ù„ÙŠÙ‡ ğŸ«¶", value: "medium" },
      { text: "Ø¯Ø§ÙŠÙ…Ù‹Ø§ ÙÙŠÙ‡ Ù‚Ù„Ù‚ ÙˆØ´Ø¯ ÙÙŠ Ø§Ù„ØªÙÙƒÙŠØ± ğŸ˜°", value: "high" },
      { text: "ØµÙˆØª Ø¹Ø§Ù„ÙŠ ÙˆÙ…Ø±Ø¨Ùƒ ÙˆÙ…Ø´ Ø¨ÙŠØ³ÙƒØª ğŸ˜µâ€ğŸ’«", value: "panic" },
    ]),
  },
  {
    question: "Ù„Ù…Ø§ ØªÙÙƒØ± ÙÙŠ Ø­ÙŠØ§ØªÙƒâ€¦ Ø¨ØªØ­Ø³ Ø¨Ø³Ù„Ø§Ù… ÙˆÙ„Ø§ ØµØ±Ø§Ø¹ØŸ",
    options: shuffle([
      { text: "Ø³Ù„Ø§Ù… ÙˆØ±Ø¶Ø§â€¦ Ù…Ø§Ø´ÙŠ ÙÙŠ Ø·Ø±ÙŠÙ‚ÙŠ âœ¨", value: "low" },
      { text: "Ø³Ù„Ø§Ù… Ù†Øµ Ù†Øµâ€¦ Ø¨Ø³ Ø¨Ø­Ø§ÙˆÙ„ Ø£Ø­Ø³Ù‘Ù† ğŸŒ€", value: "medium" },
      { text: "ØµØ±Ø§Ø¹ Ø¯Ø§Ø®Ù„ÙŠ ÙˆÙ…Ø´Ø§ÙƒÙ„ Ù†ÙØ³ÙŠØ© Ù…ØªÙƒØ±Ø±Ø© ğŸ˜£", value: "high" },
      { text: "Ø¯ÙˆØ§Ù…Ø© ØªÙˆØªØ± ÙˆÙ‚Ù„Ù‚ Ø®Ø§Ù†Ù‚ ğŸ¤¯", value: "panic" },
    ]),
  },
  {
    question: "Ù‚Ø¯Ø±ØªÙƒ Ø¹Ù„Ù‰ ØªÙ‡Ø¯Ø¦Ø© Ù†ÙØ³Ùƒâ€¦ Ø¹Ø§Ù…Ù„Ø© Ø¥Ø²Ø§ÙŠØŸ",
    options: shuffle([
      { text: "Ù…Ù…ØªØ§Ø²Ø©â€¦ Ø£Ø¹Ø±Ù Ø£Ø±Ø¬Ù‘Ø¹ Ù†ÙØ³ÙŠ ÙÙˆØ±Ù‹Ø§ ğŸ§˜â€â™‚ï¸ğŸ”¥", value: "low" },
      { text: "Ù…Ù‚Ø¨ÙˆÙ„Ø©â€¦ Ø¨Ø³ Ù…Ø­ØªØ§Ø¬ ØªØ·ÙˆØ± Ø¨Ø³ÙŠØ·", value: "medium" },
      { text: "Ø¶Ø¹ÙŠÙØ©â€¦ Ø¨ØªØ´Ø¯ Ù…Ø¹Ø§ÙŠØ§ Ø­Ø§Ø¬Ø§Øª ÙƒØªÙŠØ±", value: "high" },
      { text: "ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ Ù…Ø´ Ø¨Ø¹Ø±Ù Ø£Ù‡Ø¯Ù‘ÙŠ Ù†ÙØ³ÙŠ Ø®Ø§Ù„Øµ", value: "panic" },
    ]),
  },
]);
---

<Layout {title} {img}>
  <!-- Ù†Ø®Ø²Ù† JSON Ø¢Ù…Ù† -->
<div id="otherQuizzesData" data-json={JSON.stringify(otherQuizzes)}></div>
  <section class="quiz">
    <form id="quizForm">
      {questions.map((q, i) => (
        <div class="question">
            <h3 style="color:var(--h3); font-weight:bolder; font-size:24px;">{q.question}</h3>
          {q.options.map((opt) => (
            <label>
              <input type="radio" name={`q${i}`} value={opt.value} required />
              {opt.text}
            </label>
          ))}
        </div>
      ))}
      <button type="submit">Ø´ÙˆÙ Ø§Ù„Ù†ØªÙŠØ¬Ø© ğŸ”®</button>
    </form>

    <div id="result" class="hidden"></div>
  </section>

  <script is:inline lang="ts">
    // Ù†Ù‚Ø±Ø£ Ø§Ù„Ø¯Ø§ØªØ§ Ù…Ù† Ø§Ù„Ù€ div
    const otherQuizzes = JSON.parse(
      document.getElementById("otherQuizzesData").dataset.json
    );

    const resultsData = {
      low: {
        titles: ["Ø³Ù„Ø§Ù…Ùƒ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ù‹Ø§ âœ¨"],
        descs: [
          "Ø¹Ù†Ø¯Ùƒ Ø­Ø¶ÙˆØ± ÙˆÙ‡Ø¯ÙˆØ¡ ÙˆØ§Ø¶Ø­ÙŠÙ†.",
          "Ø¯Ù…Ø§ØºÙƒ Ù…Ø´ Ø¨ØªØ¬Ø±ÙŠ Ù…Ù†ÙƒØŒ ÙˆØ¹Ø§Ø±Ù ØªØ±Ø¬Ø¹ Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø§ØªØ²Ø§Ù† Ø¨Ø³Ù‡ÙˆÙ„Ø©.",
        ],
      },

      medium: {
        titles: ["Ø³Ù„Ø§Ù…Ùƒ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù…ÙˆØ¬ÙˆØ¯â€¦ Ø¨Ø³ Ù…Ø­ØªØ§Ø¬ Ø¯Ø¹Ù… Ø¨Ø³ÙŠØ· ğŸ«¶"],
        descs: [
          "Ø¹Ù†Ø¯Ùƒ Ø¨Ø¯Ø§ÙŠØ© ÙƒÙˆÙŠØ³Ø© Ø¬Ø¯Ù‹Ø§â€¦ Ø¨Ø³ ÙÙŠÙ‡ Ø´ÙˆÙŠØ© ØªÙˆØªØ± Ø¨ÙŠØ¸Ù‡Ø±ÙˆØ§ Ù…Ù† ÙˆÙ‚Øª Ù„Ù„ØªØ§Ù†ÙŠ.",
          "Ø´ØºÙ„ Ø¨Ø³ÙŠØ· Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¹ÙŠ ÙˆØ§Ù„ØªÙ†ÙØ³ ÙˆØ§Ù„ØªÙ‡Ø¯Ø¦Ø© ÙŠØ®Ù„ÙŠÙƒ ØªÙˆØµÙ„ Ù„Ù…Ø±Ø­Ù„Ø© Ø£Ù‚ÙˆÙ‰.",
        ],
      },

      high: {
        titles: ["Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø¹Ù†Ø¯Ùƒ Ø¶Ø¹ÙŠÙ ÙˆÙ…Ø­ØªØ§Ø¬ ØªÙ‚ÙˆÙŠØ© ğŸ˜Ÿ"],
        descs: [
          "ÙˆØ§Ø¶Ø­ Ø¥Ù† Ø°Ù‡Ù†Ùƒ ÙÙŠ ØµØ±Ø§Ø¹ ÙˆÙ‚Ù„Ù‚ ÙƒØªÙŠØ±â€¦ ÙˆØ¯Ù‡ Ø¨ÙŠØ£Ø«Ø± Ø¹Ù„Ù‰ Ø³Ù„Ø§Ù…Ùƒ Ø§Ù„Ù†ÙØ³ÙŠ.",
          "Ø¨Ø³ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ­Ø³Ù† Ø¬Ø¯Ù‹Ø§ Ø¨Ø®Ø·ÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© Ù…Ù†ØªØ¸Ù…Ø©.",
        ],
      },

      panic: {
        titles: ["Ø³Ù„Ø§Ù… Ø¯Ø§Ø®Ù„ÙŠ Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ù‹Ø§ / Ø¶ØºØ· Ù†ÙØ³ÙŠ Ø¹Ø§Ù„ÙŠ ğŸ˜£"],
        descs: [
          "Ø´ÙƒÙ„Ùƒ Ø¹Ø§ÙŠØ´ Ø­Ø§Ù„Ø© ØªÙˆØªØ± Ù…Ø³ØªÙ…Ø±Ø©ØŒ ØµÙˆØª Ø¯Ø§Ø®Ù„ÙŠ Ù…Ø²Ø¹Ø¬ØŒ Ø£ÙÙƒØ§Ø± Ø¶Ø§ØºØ·Ø©â€¦",
          "Ø¯Ù‡ Ù…Ø¤Ù„Ù…ØŒ Ø¨Ø³ Ù‚Ø§Ø¨Ù„ ÙŠØªØ­Ø³Ù† Ø¨Ø³Ø±Ø¹Ø© Ù„Ùˆ Ø¨Ø¯Ø£Øª ØªÙ‡Ø¯ÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¹ØµØ¨ÙŠ Ø´ÙˆÙŠØ© Ø¨Ø´ÙˆÙŠØ©.",
        ],
      },
    };

    const randomPick = (arr) => arr[Math.floor(Math.random() * arr.length)];

    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector("#quizForm");
      const resultDiv = document.querySelector("#result");

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const counts = {};
        for (const [_, val] of formData.entries()) {
          counts[val] = (counts[val] || 0) + 1;
        }

const top = Object.entries(counts).sort((a, b) => b[1] - a[1])[0][0];
const res = resultsData[top] || resultsData["mickey"];
// const title = randomPick(res.titles);
const title = res.titles[0];
// const desc = randomPick(res.descs);
const desc = [...res.titles.slice(1), ...res.descs].join("<br>");
const nextQuiz = randomPick(otherQuizzes);

form.style.display = "none";
  resultDiv.innerHTML = `
    <h2>${title}</h2>
    <p>${desc}</p>

          <a href="https://monce.cc/blog" 
            target="blank" style=" display: block; margin: 10px auto; padding: 12px 10px; background: #ff4081; color: #fff; border-radius: 6px; font-size: 1.1rem; text-align: center; width: 90%; max-width: 350px; line-height: 1.5; word-wrap: break-word; white-space: normal;">
            ğŸ‘ˆ Ø¬Ø±Ù‘Ø¨ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆÙ†Ø³ÙŠØ³ÙŠ
          </a>

          <button id="retry" style="margin:10px 0">Ø¬Ø±Ù‘Ø¨ ØªØ§Ù†ÙŠ ğŸ”</button>
          <div class="share-section" style="text-align:center; margin:15px 0;">
            <button id="share-result" class="share-btn" style="
              background:#ff4081;
              color:#fff;
              border:none;
              padding:10px 18px;
              border-radius:6px;
              font-size:1.1rem;
              cursor:pointer;
              box-shadow:0 2px 4px rgba(0,0,0,0.2);
            ">ğŸ“² Ø´Ø§Ø±Ùƒ Ù†ØªÙŠØ¬ØªÙƒ</button>
          </div>


          <div class="next-quiz">
            <h3 style="color: var(--accent); text-align:center;">ğŸ¯ Ø¬Ø±Ø¨ Ø§Ø®ØªØ¨Ø§Ø± ØªØ§Ù†ÙŠ!</h3>
            <a href="/tests/${nextQuiz.slug}" class="quiz-card next-card">
              <img class="img" src="${nextQuiz.img}" alt="${nextQuiz.title}" loading="lazy" />
              <div class="content">
                <h3 style="color: var(--accent)">${nextQuiz.title}</h3>
              </div>
            </a>
          </div>
        `;

        // ğŸ‘‡ Ø§Ù„Ø³Ø·Ø±ÙŠÙ† Ø§Ù„Ù„ÙŠ ÙƒØ§Ù†ÙˆØ§ Ù†Ø§Ù‚ØµÙŠÙ†
        resultDiv.classList.remove("hidden");
        resultDiv.scrollIntoView({ behavior: "smooth" });

        const currentUrl = window.location.href;

        // âœ… Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
        document.querySelector("#share-result").addEventListener("click", async () => {
          const resultTitle = res.titles[0];

          // ğŸ”¥ ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙˆØµÙ Ù…Ù† Ø£ÙŠ HTML ÙƒØ§Ù…Ù„
          const cleanDesc = res.descs
            .map(d => d.replace(/<[^>]+>/g, "")) 
            .join("\n");

          const text =
        `Ù†ØªÙŠØ¬ØªÙƒ: ${resultTitle}

        ${cleanDesc}

        â€”
        Ø¬Ø±Ø¨ Ù†ØªÙŠØ¬ØªÙƒ Ø¹Ù„Ù‰ Ù„ÙˆÙ„ Ù…ÙŠ ğŸ˜‚ğŸ”¥
        ${currentUrl}`;

          try {
            if (navigator.share) {
              await navigator.share({
                title: resultTitle,
                text: text,  // Ù…Ù† ØºÙŠØ± URL Ù‡Ù†Ø§
              });
            } else {
              alert("Ø¬Ù‡Ø§Ø²Ùƒ Ù…Ø´ Ø¨ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©. Ø§Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙŠØ¯ÙˆÙŠÙ‹Ø§ ğŸ˜…");
            }
          } catch (err) {
            console.log("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£:", err);
          }
        });

        document.querySelector("#retry").addEventListener("click", () => {
          location.reload();
        });

      });
    });
  </script>

<script type="module" src="/js/tilt-cards.js"></script>
  <style>
    .quiz { max-width: 650px; margin: auto; text-align: center; }
    label { display: block; margin: 8px 0; padding: 8px; border-radius: 6px; cursor: pointer; background: var(--bg-color); box-shadow: 0 1px 2px var(--shadow-color); }
    label:hover { background: var(--header-link-hover); }
    button { margin-top: 20px; padding: 10px 20px; font-size: 1.2rem; border: none; background: #ff4081; color: #fff; border-radius: 6px; cursor: pointer; }
    .hidden { display: none; }
    #result { margin-top: 30px; padding: 20px; background: var(--bg-color); box-shadow: 0 2px 3px var(--shadow-color); border-radius: 8px; animation: fadeIn 0.4s ease-in-out; }
    .next-quiz { margin-top: 20px; background: var(--bg-color); padding: 15px; border-radius: 8px; }
    .quiz-card img { width: 100%; height: 180px; object-fit: cover; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</Layout>
