---
export const prerender = false;
import Layout from "../../layouts/Layout.astro";
import { otherQuizzes } from "../../data/otherQuizzes.js";

const title = "Ø´Ø®ØµÙŠØªÙƒ ØªØ´Ø¨Ù‡ Ù…ÙŠÙ† Ù…Ù† Ø§Ù„ÙƒØ±ØªÙˆÙ†ØŸ ğŸ§¸";
const img = "/images/cartoon.webp";

interface Option {
  text: string;
  value: "mickey" | "spongebob" | "tom" | "jerry";
}

interface Question {
  question: string;
  options: Option[];
}

function shuffle<T>(arr: T[]): T[] {
  return arr.sort(() => Math.random() - 0.5);
}

const questions: Question[] = shuffle([
  {
    question: "Ù„Ù…Ø§ ØªÙˆØ§Ø¬Ù‡ Ù…Ø´ÙƒÙ„Ø©ØŒ Ø¥Ù†Øª Ø¨ØªØªØµØ±Ù Ø¥Ø²Ø§ÙŠØŸ",
    options: shuffle([
      { text: "Ø°ÙƒÙŠ ÙˆØ¨Ø§Ø±Ø¹ Ø²ÙŠ Ù…ÙŠÙƒÙŠ ğŸ­", value: "mickey" },
      { text: "Ù…ØºØ§Ù…Ø± ÙˆÙ…Ø¶Ø­Ùƒ Ø²ÙŠ Ø³Ø¨ÙˆÙ†Ø¬ Ø¨ÙˆØ¨ ğŸ§½", value: "spongebob" },
      { text: "Ù…Ø®Ø·Ø· ÙˆÙ…Ø¶Ø·Ø±Ø¨ Ø²ÙŠ ØªÙˆÙ… ğŸ±", value: "tom" },
      { text: "Ø³Ø±ÙŠØ¹ ÙˆÙ…Ø´Ø§ØºØ¨ Ø²ÙŠ Ø¬ÙŠØ±ÙŠ ğŸ­", value: "jerry" },
    ]),
  },
  {
    question: "Ø£ØµØ­Ø§Ø¨Ùƒ ÙŠÙˆØµÙÙˆÙƒ Ø¨Ø¥ÙŠÙ‡ØŸ",
    options: shuffle([
      { text: "Ø°ÙƒÙŠ ÙˆÙ‚ÙŠØ§Ø¯ÙŠ ğŸ’¡", value: "mickey" },
      { text: "Ù…Ø¶Ø­Ùƒ ÙˆÙ…Ø±Ø­ ğŸ˜‚", value: "spongebob" },
      { text: "Ù…Ù†Ø§ÙØ³ ÙˆØ¯Ù‡Ø§Ø¡ ğŸ˜", value: "tom" },
      { text: "Ù…Ø´Ø§ØºØ¨ ÙˆØ³Ø±ÙŠØ¹ âš¡ï¸", value: "jerry" },
    ]),
  },
  {
    question: "ÙÙŠ ÙˆÙ‚Øª ÙØ±Ø§ØºÙƒØŒ Ø¥Ù†Øª Ø¹Ø§Ø¯Ø©ØŸ",
    options: shuffle([
      { text: "Ø¨ØªØ®Ø·Ø· Ù„ÙƒÙ„ Ø­Ø§Ø¬Ø© ğŸ“", value: "mickey" },
      { text: "Ø¨ØªØ­Ø¨ Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„Ù…ØºØ§Ù…Ø±Ø© ğŸ–ï¸", value: "spongebob" },
      { text: "Ø¨ØªÙ„Ø§Ø­Ù‚ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø¨Ù„Ø§ ØªÙˆÙ‚Ù ğŸƒâ€â™‚ï¸", value: "tom" },
      { text: "Ø¨ØªØ­Ø¨ Ø§Ù„ÙÙˆØ¶Ù‰ ÙˆØ§Ù„Ù…Ø±Ø­ ğŸ˜œ", value: "jerry" },
    ]),
  },
  {
    question: "Ø£Ù‡Ù… Ø­Ø§Ø¬Ø© ÙÙŠ Ø´Ø®ØµÙŠØªÙƒØŸ",
    options: shuffle([
      { text: "Ø­ÙƒÙ…Ø© ÙˆØ°ÙƒØ§Ø¡ ğŸ¤“", value: "mickey" },
      { text: "Ù…Ø±Ø­ ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© ğŸŒˆ", value: "spongebob" },
      { text: "ØªØ­Ø¯ÙŠ ÙˆÙ…Ù†Ø§ÙØ³Ø© ğŸ’¥", value: "tom" },
      { text: "Ø¯Ù‡Ø§Ø¡ ÙˆÙ…Ù‡Ø§Ø±Ø© ğŸ¯", value: "jerry" },
    ]),
  },
]);
---

<Layout {title} {img}>
  <!-- Ù†Ø®Ø²Ù† JSON Ø¢Ù…Ù† -->
<div id="otherQuizzesData" data-json={JSON.stringify(otherQuizzes)}></div>

  <section class="quiz">
    <form id="quizForm">
      {questions.map((q, i) => (
        <div class="question">
            <h3 style="color:var(--h3); font-weight:bolder; font-size:24px;">{q.question}</h3>
          {q.options.map((opt) => (
            <label>
              <input type="radio" name={`q${i}`} value={opt.value} required />
              {opt.text}
            </label>
          ))}
        </div>
      ))}
      <button type="submit">Ø´ÙˆÙ Ø§Ù„Ù†ØªÙŠØ¬Ø© ğŸ”®</button>
    </form>

    <div id="result" class="hidden"></div>
  </section>

  <script is:inline lang="ts">
    // Ù†Ù‚Ø±Ø£ Ø§Ù„Ø¯Ø§ØªØ§ Ù…Ù† Ø§Ù„Ù€ div
    const otherQuizzes = JSON.parse(
      document.getElementById("otherQuizzesData").dataset.json
    );

    const resultsData = {
        mickey: {
            titles: ["Ø¥Ù†Øª Ù…ÙŠÙƒÙŠ ğŸ­", "Ø°ÙƒÙŠ ÙˆÙ‚ÙŠØ§Ø¯ÙŠ ğŸ’¡", "Ø´Ø®ØµÙŠØ© Ù…Ø­Ø¨ÙˆØ¨Ø© ğŸ‘‘"],
            descs: [
            "Ø¨ØªØªÙ…ÙŠØ² Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ ÙˆØ§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ­Ø¨ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.",
            "Ø´Ø®ØµÙŠØªÙƒ Ù…Ø³ØªÙ‚Ø±Ø© ÙˆÙ‡Ø§Ø¯Ø¦Ø© ÙˆÙ†Ø§Ø³ ÙƒØªÙŠØ± Ø¨ØªØ­Ø¨Ùƒ.",
            "ØªØ®Ø·ÙŠØ·Ùƒ ÙˆØ­ÙƒÙ…ØªÙƒ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø¨ØªØ®Ù„ÙŠ Ø§Ù„ÙƒÙ„ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„ÙŠÙƒ.",
            ],
        },
        spongebob: {
            titles: ["Ø¥Ù†Øª Ø³Ø¨ÙˆÙ†Ø¬ Ø¨ÙˆØ¨ ğŸ§½", "Ù…ØºØ§Ù…Ø± ÙˆÙ…Ø¶Ø­Ùƒ ğŸ˜‚", "Ù…Ù„ÙŠØ§Ù† Ø·Ø§Ù‚Ø© ğŸŒŸ"],
            descs: [
            "Ù…Ø±Ø­ ÙˆÙ…Ø¶Ø­Ùƒ ÙˆØ¨ØªØ­Ø¨ Ø§Ù„Ù„Ø¹Ø¨ ÙˆØ§Ù„Ù…ØºØ§Ù…Ø±Ø©.",
            "Ù†Ø´Ø§Ø·Ùƒ ÙˆØ­ÙŠÙˆÙŠØªÙƒ Ø¨ØªØ®Ù„ÙŠ Ø§Ù„ÙƒÙ„ Ù…Ø¨Ø³ÙˆØ· Ø­ÙˆØ§Ù„ÙŠÙƒ.",
            "Ø¥ÙŠØ¬Ø§Ø¨ÙŠØªÙƒ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø¨ØªÙ†Ø¹ÙƒØ³ Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙŠ Ø­ÙˆØ§Ù„ÙŠÙƒ.",
            ],
        },
        tom: {
            titles: ["Ø¥Ù†Øª ØªÙˆÙ… ğŸ±", "Ù…Ø®Ø·Ø· ÙˆÙ…Ù†Ø§ÙØ³ ğŸ˜", "Ø¯Ø§Ø¦Ù… Ø§Ù„Ø­Ø±ÙƒØ© âš¡ï¸"],
            descs: [
            "Ø¨ØªØ­Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠ ÙˆØ§Ù„Ù…Ù†Ø§ÙØ³Ø© ÙˆÙ…Ø§ Ø¨ØªØ³ØªØ³Ù„Ù…Ø´.",
            "Ø¯Ù‡Ø§Ø¡Ùƒ ÙˆØ­Ø¨Ùƒ Ù„Ù„ØªØ®Ø·ÙŠØ· Ø¨ÙŠÙ…ÙŠØ²Ùƒ Ø¹Ù† ØºÙŠØ±Ùƒ.",
            "Ù†Ø´Ø§Ø·Ùƒ ÙˆØ­Ø±ÙƒØªÙƒ Ù…Ø³ØªÙ…Ø±Ø© ÙˆØ¨ØªØ­Ø¨ ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒ.",
            ],
        },
        jerry: {
            titles: ["Ø¥Ù†Øª Ø¬ÙŠØ±ÙŠ ğŸ­", "Ù…Ø´Ø§ØºØ¨ ÙˆØ³Ø±ÙŠØ¹ âš¡ï¸", "Ø°ÙƒÙŠ ÙˆÙØ·ÙŠÙ† ğŸ§ "],
            descs: [
            "Ø¯Ù‡Ø§Ø¡Ùƒ ÙˆØ°ÙƒØ§Ø¡Ùƒ Ø¨ÙŠØ®Ù„ÙˆÙƒ ØªØªÙÙˆÙ‚ ÙÙŠ Ø£ÙŠ Ù…ÙˆÙ‚Ù.",
            "Ø³Ø±Ø¹ØªÙƒ ÙˆÙ…Ù‡Ø§Ø±ØªÙƒ ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ù Ø±Ø§Ø¦Ø¹Ø©.",
            "Ø´Ø®ØµÙŠØªÙƒ ÙØ·Ù†Ø© ÙˆÙ…Ø­Ø¨ÙˆØ¨Ø© Ø±ØºÙ… Ø§Ù„Ù…Ø´Ø§ØºØ¨Ø§Øª ğŸ˜„",
            ],
        },
    };

    const randomPick = (arr) => arr[Math.floor(Math.random() * arr.length)];

    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector("#quizForm");
      const resultDiv = document.querySelector("#result");

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const formData = new FormData(form);
        const counts = {};
        for (const [_, val] of formData.entries()) {
          counts[val] = (counts[val] || 0) + 1;
        }

        const top = Object.entries(counts).sort((a, b) => b[1] - a[1])[0][0];
const res = resultsData[top] || resultsData["mickey"];
        // const title = randomPick(res.titles);
        const title = res.titles[0];
        // const desc = randomPick(res.descs);
const desc = [...res.titles.slice(1), ...res.descs].join("<br>");
        const nextQuiz = randomPick(otherQuizzes);

        form.style.display = "none";
          resultDiv.innerHTML = `
            <h2>${title}</h2>
            <p>${desc}</p>
            <button id="retry" style="margin:0 0 10px 0">Ø¬Ø±Ù‘Ø¨ ØªØ§Ù†ÙŠ ğŸ”</button>

            <div class="share-section" style="text-align:center; margin:15px 0;">
              <button id="share-result" class="share-btn" style="
                background:#ff4081;
                color:#fff;
                border:none;
                padding:10px 18px;
                border-radius:6px;
                font-size:1.1rem;
                cursor:pointer;
                box-shadow:0 2px 4px rgba(0,0,0,0.2);
              ">ğŸ“² Ø´Ø§Ø±Ùƒ Ù†ØªÙŠØ¬ØªÙƒ</button>
            </div>

            <div class="next-quiz">
              <h3 style="color: var(--accent); text-align:center;">ğŸ¯ Ø¬Ø±Ø¨ Ø§Ø®ØªØ¨Ø§Ø± ØªØ§Ù†ÙŠ!</h3>
              <a href="/tests/${nextQuiz.slug}" class="quiz-card next-card">
                <img class="img" src="${nextQuiz.img}" alt="${nextQuiz.title}" loading="lazy" />
                <div class="content">
                  <h3 style="color: var(--accent)">${nextQuiz.title}</h3>
                  <p>Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯ ÙˆÙ…Ù…ØªØ¹ Ù…Ù† Ù„ÙˆÙ„ Ù…ÙŠ ğŸ˜ <br>
                  Ø§Ø¶ØºØ· ÙˆØ§Ø¨Ø¯Ø£ Ø¯Ù„ÙˆÙ‚ØªÙŠ! lolme.cc
                  </p>
                </div>
              </a>
            </div>
          `;

        // ğŸ‘‡ Ø§Ù„Ø³Ø·Ø±ÙŠÙ† Ø§Ù„Ù„ÙŠ ÙƒØ§Ù†ÙˆØ§ Ù†Ø§Ù‚ØµÙŠÙ†
        resultDiv.classList.remove("hidden");
        resultDiv.scrollIntoView({ behavior: "smooth" });

        const currentUrl = window.location.href;

        // âœ… Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
        document.querySelector("#share-result").addEventListener("click", async () => {
          const resultTitle = res.titles[0];

          // ğŸ”¥ ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙˆØµÙ Ù…Ù† Ø£ÙŠ HTML ÙƒØ§Ù…Ù„
          const cleanDesc = res.descs
            .map(d => d.replace(/<[^>]+>/g, "")) 
            .join("\n");

          const text =
        `Ù†ØªÙŠØ¬ØªÙƒ: ${resultTitle}

        ${cleanDesc}

        â€”
        Ø¬Ø±Ø¨ Ù†ØªÙŠØ¬ØªÙƒ Ø¹Ù„Ù‰ Ù„ÙˆÙ„ Ù…ÙŠ ğŸ˜‚ğŸ”¥
        ${currentUrl}`;

          try {
            if (navigator.share) {
              await navigator.share({
                title: resultTitle,
                text: text,  // Ù…Ù† ØºÙŠØ± URL Ù‡Ù†Ø§
              });
            } else {
              alert("Ø¬Ù‡Ø§Ø²Ùƒ Ù…Ø´ Ø¨ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©. Ø§Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙŠØ¯ÙˆÙŠÙ‹Ø§ ğŸ˜…");
            }
          } catch (err) {
            console.log("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£:", err);
          }
        });

        document.querySelector("#retry").addEventListener("click", () => {
          location.reload();
        });

      });
    });
  </script>

<script type="module" src="/js/tilt-cards.js"></script>
  <style>
    .quiz { max-width: 600px; margin: auto; text-align: center; }
    label { display: block; margin: 8px 0; padding: 8px; border-radius: 6px; cursor: pointer; background: var(--bg-color); box-shadow: 0 1px 2px var(--shadow-color); }
    label:hover { background: var(--header-link-hover); }
    button { margin-top: 20px; padding: 10px 20px; font-size: 1.2rem; border: none; background: #ff4081; color: var(--accent); border-radius: 6px; cursor: pointer; }
    .hidden { display: none; }
    #result { margin-top: 30px; padding: 20px; background: var(--bg-color); box-shadow: 0 2px 3px var(--shadow-color); border-radius: 8px; animation: fadeIn 0.5s ease-in-out; }
    .next-quiz { margin-top: 20px; background: var(--bg-color); padding: 15px; border-radius: 8px; }
    .quiz-card img { width: 100%; height: 180px; object-fit: cover; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</Layout>
